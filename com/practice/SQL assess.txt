DELETE o FROM orders o
JOIN (SELECT MIN(orderId) AS orderId, custId, orderDate     FROM orders    
GROUP BY custId, orderDate     
HAVING COUNT(*) > 1) AS duplicates ON o.custId = duplicates.custId 
AND 
o.orderDate = duplicates.orderDate
WHERE o.orderId != duplicates.orderId;



1)In Employees_Projects table some rows reference employees 
who no longer exist in the employees table. Remove these orphaned rows

delete ep
from Employees_Projects ep
left join employees e on ep.employee_id = e.employee_id
where e.employee_id is null;






2) Detect Salary gaps
hint: you want to compare the average salary between departments.

select department_id, avg(salary) as avg_sal from employees
group by department_id
order by avg_sal desc;





3)Employees working on more than 1 project
select employee_id
from employees_projects
group by employee_id
having count(project_id) > 1;




